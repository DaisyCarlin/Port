# -*- coding: utf-8 -*-
"""F1 champs

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/128gk_gVshja_kjLr_iCTPkQMzE7Lf2LW
"""

#!pip install pandas
#!pip install zipfile
#!pip install kaggle

from geopy.geocoders import GoogleV3
geolocator = GoogleV3(api_key="AIzaSyDRQy99bcTywdn2cSNhod-JOtwKJqzpl6w")
from geopy.exc import GeocoderTimedOut
from geopy.extra.rate_limiter import RateLimiter

import zipfile
import pandas as pd
import kaggle

!kaggle datasets download -d kaggle datasets download -d rakeshkudmulwar7/formula-1-race-winners-20122022

zipfile_name = 'race'
with zipfile.ZipFile(zipfile_name, 'r') as file:
  file.extractall()
  print('done')

Winners = pd.read_csv("F1 Seasons champions.csv")

Winners

# Rename the 'Grand Prix' column to 'Location'
Winners = Winners.rename(columns={'Grand Prix': 'Location'})

Winners

Winners = Winners.drop('Unnamed: 0', axis=1)

Winners

Winners = Winners.head(21)

Winners

num_rows = Winners.shape[0]
print(f"The DataFrame has {num_rows} rows.")

def get_lat_long(Location):
  address = f"{Location}"
  try:
    geolocator = GoogleV3(api_key="AIzaSyDRQy99bcTywdn2cSNhod-JOtwKJqzpl6w", user_agent="rank", timeout=20)
    location = geolocator.geocode(address)
    if location:
      return location.latitude, location.longitude
    else:
      return None, None
  except GeocoderTimedOut:
    return None, None

Winners['latitude'], Winners['longitude'] = zip(*Winners.apply(lambda x: get_lat_long(x['Location']), axis=1))

print(Winners.columns)

Winners = Winners.drop('Unnamed: 0', axis=1)

Winners

Winners.to_excel('F1_Fin_Champ_Final.xlsx', sheet_name='data')
